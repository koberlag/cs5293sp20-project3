# CS5293SP20-PROJECT3
    AUTHOR: RANDAL KEVIN OBERLAG JR.

## APPLICATION DESCRIPTION

    THIS APPLICATION TAKES A LIST OF INGREDIENTS FROM A USER AND
    ATTEMPTS TO PREDICT THE TYPE OF CUISINE AND SIMILAR MEALS. THE
    APPLICATION PRE-TRAINS AN EXISTING DATA SET OF CUISINES AND INGREDIENTS
    FROM YUMMLY, USING A COUNT VECTORIZER AND LOGISTIC REGRESSION CLASSIFIER.
    THE TRAINED MODEL IS THEN USED FOR THE PREDICTIONS OF THE CUISINE AND
    SIMILAR MEALS. THE APPLICATION HAS A WEB INTERFACE FOR USER INPUT, AND
    USES THE FLASK WEB FRAMEWORK.


## HOW DID YOU TURN YOUR TEXT INTO FEATURES AND WHY?
    I USED THE COUNT VECTORIZER FROM SKLEARN TO CREATE THE FEATURES.
    FIRST THE INGREDIENTS PER YUMMLY RECORD WERE GROUPED INTO A SINGLE
    STRING SO THAT THEY COULD BE PASSED TO THE VECTORIZER FOR EACH ID.
    THE INGREDIENTS WERE THEN CLEANED AND TOKENIZED WITH SPACY, VIA THE
    COUNT TOKENIZER ATTRIBUTE. TF-IDF AND COUNTVECTORIZER WERE BOTH TRIED,
    BUT COUNT VECTORIZER ACHIEVED SLIGHTLY HIGHER EVALUATION SCORES, AND
    WAS THEREFORE CHOSEN.


## WHAT CLASSIFIERS/CLUSTERING METHODS DID YOU CHOOSE AND WHY?
    I CHOSE THE LOGISTIC REGRESSION CLASSIFIER BECAUSE IT SEEMED
    TO GIVE DECENT RESULTS, WITH 78% MEAN ACCURACY. WITH MORE 
    TUNING IT COULD LIKELY BE IMPROVED.


## WHAT N DID YOU CHOOSE AND WHY?
    I CHOSE N = 4 SIMPLY BECAUSE IT SEEMS LIKE IF 
    SOMEONE WERE WANTING TO SEE ALTERNATIVE RECIPES, THEY WOULD WANT AT LEAST A FEW OPTIONS
    BUT MAY NOT WANT A HUGE LIST.


## DOWNLOADING THE APPLICATION

USE GIT CLONE TO DOWNLOAD THIS APPLICATION. IN YOUR TERMINAL, NAVIGATE TO THE DIRECTORY THAT YOU WOULD LIKE THE APPLICATION TO RUN, THEN RUN THE FOLLOWING GIT COMMAND:

    GIT CLONE HTTPS://GITHUB.COM/KOBERLAG/CS5293SP20-PROJECT3.GIT

## INSTALLING THE APPLICATION

THIS APPLICATION RELIES ON THE PIPENV PACKAGE, SO YOU WILL NEED TO INSTALL PIPENV USING THE PIP PACKAGE MANAGEMENT TOOL. RUN THE FOLLOWING COMMAND TO INSTALL PIPENV: 

    PIP INSTALL PIPENV

ONCE PIPENV IS INSTALLED, YOU WILL THEN BE ABLE TO INSTALL THE REQUIRED PACKAGES THAT ARE USED BY THIS APPLICATION (EXTERNAL LIBRARIES LISTED BELOW). RUN THE FOLLOWING COMMAND TO INSTALL THE EXTERNAL LIBRARIES:

    PIPENV INSTALL

THIS APPLICATION ALSO RELIES ON A LANGUAGE PACKAGE FOR THE SPACY LIBRARY, THEREFORE THE FOLLOWING COMMAND MUST BE RUN FROM WITHIN YOUR TERMINAL (INSIDE YOUR VIRTUAL ENVIRONMENT):

    PYTHON -M SPACY DOWNLOAD EN_CORE_WEB_SM

## RUNNING THE APPLICATION

THE APPLICATION MAY BE RUN USING THE FOLLOWING COMMANDS: 
    
    PIPENV SHELL
    FLASK_APP=PROJECT3/APP.PY FLASK RUN


## TESTING THE APPLICATION

THE TESTS FOR THE APPLICATION MAY BE RUN USING THE FOLLOWING COMMAND:

    PIPENV RUN PYTHON -M PYTEST


## APPLICATION FUNCTIONS:


- READ_YUMMLY_JSON(): LOAD THE YUMMLY.JSON DATA INTO A PANDAS DATAFRAME AND RETURN

- SPACY_TOKENIZER(SENTENCE): USES THE SPACY LIBRARY TO TOKENIZE SENTENCES, LEMMATIZING EACH TOKEN AND CONVERTING TO LOWERCASE.

- EVALUATE_MODEL(CLASSIFIER, FEATURES, LABELS): USED FOR TESTING MODEL CLASSIFIER. 
    USES CROSS_VAL_SCORE METHOD TO CROSS VALIDATE THE CLASSIFIER USING THE FEATURES AND LABELS FROM THE YUMMLY DATA.

- CREATE_MODEL_VEC_MATRIX(DF): CREATES THE VECTORIZER, CLASSIFICATION MODEL, 
    AND FEATURE MATRIX FROM THE YUMMLY DATA FRAME. USES THE PICKLE FUNCTIONALITY TO PERSIST THE THREE OBJECTS.

- GET_MODEL_VEC_MATRIX(DF): RETRIEVES THE PICKLE FILES THAT ARE PERSISTED FOR THE VECTORIZER, 
    CLASSIFICATION MODEL, AND FEATURE MATRIX, OR IF THEY DO YET EXISTS, A THE OBJECTS ARE CREATED AND PERSISTED.

- PICKLE_MODEL_VEC_MATRIX(MODEL, VECTORIZER, FEATURE_MATRIX): CREATES THE PERSISTED FILES FOR THE MODEL, VECORIZER, AND FEATURE MATRIX.

- CREATE_VECTORIZER(): CREATES AND RETURNS A COUNT VECTORIZER.

- CREATE_CLASSIFIER(): CREATES AND RETURNS A LOGISTICS REGRESSION CLASSIFIER.

- GET_BEST_MATCH_CUISINE(VECTORIZER, MODEL, FEATURE_MATRIX): USED THE TRAINED MODEL AND THE FEATURE MATRIX 
    OF THE USER INPUT, TO DETERMINE THE BEST MATCHING CUISINE.

- GET_CLOSEST_RECIPES(FEATURE_MATRIX, USER_RECIPE_FEATURE_MATRIX, DF, N_RECIPES): USES THE FEATURE MATRIX FROM THE USER INPUT
     AND THE FEATURE MATRIX USED TO BUILD THE MODEL AS INPUT INTO THE COSINE SIMILARITY FUNCTION.
    RETURNS THE IDS AND THE SIMILARITY SCORE AS A TUPLE.
  
- ANALYZE_INGREDIENTS(USER_INGREDIENTS): ACCEPTS A LIST OF USER INPUT INGREDIENTS AND
    CREATES A FEATURE MATRIX 
    FOR USING IN THE EXISTING MODEL. THE MODEL WILL RETURN THE BEST MATCH FOR
    CUISINE TYPE. IN ADDITION A CLOSEST RECIPES ARE DETERMINED USING COSINE SIMILARITY.
    RETURNS THE CUISINE TYPE AND PROB AS A TUPLE AS WELL AS THE CLOSEST RECIPES AS A TUPLE
    OF THE RECIPE ID AND SIMILARITY SCORE.

## TEST FUNCTIONS:

- test_read_yummly_json(): Tests that a data frame is returned

- test_spacy_tokenizer(): Tests the sentence "A token test" and ensures that a list of tokens containing only "token" and "test are returned, since stop words should be removed.

- test_create_model_vec_matrix(): Tests that a logistic regression model, count vectorizer, and a feature matrix are returned.

- test_get_model_vec_matrix():Tests that a logistic regression model, count vectorizer, and a feature matrix are returned.

- test_create_vectorizer(): Tests that a count vectorizer is returned.

- test_create_classifier(): Tests that logistic regression classifier is returned.

- test_get_best_match_cuisine(): Test that a best match is returned and a prob > 0 is returned.

- test_get_closest_recipes(): Tests that a closest_recipes value is returned
and that the length is the given size of n=2.
  
- test_analyze_ingredients(): Tests that a best match tuple is returned with the first element not being empty, and the second being greater than 0. Tests the closest_matches tuple list, and ensures that the length is n=4 and that the first element of the first tuple is not empty, and that the second element of the first tuple is >= 0.

## KNOWN BUGS:

- NONE

## ADDITIONAL ASSUMPTIONS:

- THE MODEL COULD BE BETTER AND NEEDS TO BE TWEAKED MORE. THE MEAN ACCURACY IS RETURNING AROUND 78%

## EXTERNAL LIBRARIES
-   SPACY
-   SKLEARN
-   NUMPY
-   PANDAS
-   PYLINT
-   FLASK

## REFERENCES
-   TEXT ANALYTICS WITH PYTHON: A PRACTITIONER'S GUIDE TO NATURAL LANGUAGE PROCESSING. (SECOND EDITION). DIPANJAN SARKAR 


## EXTERNAL RESOURCES

-   HTTPS://SCIKIT-LEARN.ORG - FOR LOGISTIC REGRESSION, COSINE_SIMILARITY, AND CROSS_VAL_SCORE

-   HTTPS://FLASK.PALLETSPROJECTS.COM/EN/1.1.X/ - FOR FLASK WEB APP